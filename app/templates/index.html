<!doctype html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <title>Domowa Biblioteka</title>
</head>
<body>
    <h1>Domowa Biblioteka</h1>

    <h2>{{ 'Edytuj książkę' if editing_id else 'Dodaj nową książkę' }}</h2>

    <form method="POST">
        {{ form.hidden_tag() }}

        <p>
            {{ form.title.label }}<br>
            {{ form.title(size=50) }}<br>
            {% for error in form.title.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.authors.label }}<br>
            {{ form.authors(size=50) }}<br>
            {% for error in form.authors.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.year.label }}<br>
            {{ form.year(size=10) }}<br>
            {% for error in form.year.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.genre.label }}<br>
            {{ form.genre(size=50) }}<br>
            {% for error in form.genre.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.pages.label }}<br>
            {{ form.pages(size=10) }}<br>
            {% for error in form.pages.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.description.label }}<br>
            {{ form.description(rows=4, cols=60) }}<br>
            {% for error in form.description.errors %}
                <span style="color: red;">{{ error }}</span><br>
            {% endfor %}
        </p>

        <p>
            {{ form.is_available() }}
            {{ form.is_available.label }}
        </p>

        <p>
            {{ form.submit() }}
            {% if editing_id %}
                <a href="{{ url_for('index') }}">Anuluj edycję</a>
            {% endif %}
        </p>
    </form>

    <hr>

    <h2>Lista książek</h2>

    {% if books %}
        <table border="1" cellpadding="6" cellspacing="0">
            <tr>
                <th>Tytuł</th>
                <th>Autorzy</th>
                <th>Rok</th>
                <th>Gatunek</th>
                <th>Liczba stron</th>
                <th>Opis</th>
                <th>Dostępna</th>
                <th>Akcje</th>
            </tr>
            {% for book in books %}
            <tr>
                <td>{{ book.title }}</td>
                <td>{{ book.authors | map(attribute='name') | join(', ') }}</td>
                <td>{{ book.year or '' }}</td>
                <td>{{ book.genre or '' }}</td>
                <td>{{ book.pages or '' }}</td>
                <td>{{ book.description or '' }}</td>
                <td>{{ 'Tak' if book.is_available else 'Nie' }}</td>
                <td>
                    <a href="{{ url_for('index', book_id=book.id) }}">Edytuj</a> |
                    <form action="{{ url_for('delete_book', book_id=book.id) }}" method="POST" style="display:inline;">
                        <button type="submit" onclick="return confirm('Na pewno usunąć tę książkę?');">Usuń</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>Brak książek w bazie.</p>
    {% endif %}
</body>
</html>
